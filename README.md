# mysite
## 用django搭建博客系统

1. 创建工程：django-admin startproject mysite
2. 启动一个本地服务器：python manage.py runserver
3. 创建一个应用，切换目录到 manage.py 所在文件夹：python manage.py startapp blog
4. 创建博客的数据库模型，我们的文章都存储在数据库中，当访问时，django从数据库中去拿我们需要的数据，但是我们不需要自己去编写SQL语言，Django 把那一套数据库的语法转换成了 Python 的语法形式，我们只要写 Python 代码就可以了，Django 会把 Python 代码翻译成对应的数据库操作语言，即ORM
5. 编写数据库模型代码，我们将这些到吗都写在blog/models.py文件中，比如分类，标签，发布的文章等，一个类就代表一个数据库表，我们定义了分类，标签，和文章三个类，但是在文章类中涉及到的字段比较多，有标题，正文，摘要，创建时间，最后修改时间，分类与标签，作者等；同时我们需要在文章中可以访问到分类与标签的数据，所以这里需要将这分类和标签的表与文章的表做一个关联；关联方式我们用到了一对多，和多对多两种方式
6. 迁移博客数据库代码：我们只是用python语言写好了数据库模型代码，但是django还需要把它翻译为数据库语言，才能在数据库中真正的创建数据库表；
7. 运行python manage.py makemigrations之后，django 在blog应用的migrations\目录下生成一个0001_initial.py文件，专门用来记录我们多模型做了哪些修改，不过这个命令只是告诉我们做了哪些改变，还没有真正创建数据库
8. 运行python manage.py migrate之后，django 会检测migrations\ 目录下的文件，得知我们都做了哪些修改后，然后它就把这些操作都翻译成为数据库语言，从而这些操作将作用于真正的数据库
9. django 打开交互式命令行：python manage.py shell
10. 上面这些做完之后就可以写文章了，但是在写文章之前，需要创建一个超级账户，输入命令：python manage.py createsuperuser，之后按照提示输入即可创建
11. 我们从数据库中取数据时用到了`objects` 模型管理器，它提供了一系列从数据库中取数据的方法
12. 我们从数据库中取出数据后，显示的是字符串，而无法看出取出的内容，所以这里定义一个 `__str__` 方法，定义好 `__str__` 方法后，解释器显示的内容将会是 `__str__` 方法返回的内容。这里 `Category` 返回分类名 `name` ，`Tag` 返回标签名，而 `Post` 返回它的 `title`。
13. Django 处理 HTTP 请求：接受浏览器发来的HTTP请求，返回相应的HTTP相应。所以有以下几个问题：如何接受请求？如何处理请求？如何生成响应？对于如何处理这些问题，Django 有其一套规定的机制。
14. 首先，当用户访问不同的网址时，Django会把不同网址对应的处理函数写在当前应用中的一个url.py文件中，当用户访问某个网址时，Django就会去这个文件中找，如果找到这个网址，就会调用和它绑定在一起的处理函数（视图函数）。
15. 绑定之后就要去写相应的处理函数了，在当前应用文件夹下的views.py文件中写
16. 绑定好url和视图函数还需要做最后一步，就是告诉django我们绑定好了，于是需要在settings.py文件所在文件夹下的url.py文件中包含我们新建的url.py文件，这样Django处理HTTP请求的过程就完成了
17. 这基本就是Django的开发流程了，写好处理http请求和返回http响应的视图函数，然后把视图函数绑定到响应的url上
18. 模板系统：在我们的项目**根目录**（即 manage.py 文件所在目录）下建立一个名为 templates 的文件夹，用来存放我们的模板。然后在 templates\ 目录下建立一个名为 blog 的文件夹，用来存放和 blog 应用相关的模板。当然模板存放在哪里是无关紧要的，只要 Django 能够找到的就好。但是我们建立这样的文件夹结构的目的是把不同应用用到的模板隔离开来，这样方便以后维护。我们在 templates\blog 目录下建立一个名为 index.html 的文件，这个文件就是主页的模板文件，我们可以在里面添加东西了
19. 标准的HTML文档，这里涉及到几个陌生的知识：

- {{ }}: 这样用{{ }}包起来的变量叫做模板变量，django在渲染这个模板的时候会根据我们传递给模板的变量替换掉这些变量，最终在模板中显示我们要传递的值
- {% %} ：用 {% %} 包裹起来的叫做模板标签，其作用是在最终渲染的模板里显示由视图函数传过来的变量值。
- {% for %} 模板标签，遍历循环
- {% empty %} 当为空时，显示{% empty %} 下的内容
- {% endfor %} 循环结束
- 

1. 模板写好之后，还需要告诉django 去哪里找模板，这时候需要在setting.py文件里设置一下模板文件所在的路径，在这个文件中有一个TEMPLATE选项，在'DIRS':的位置设置好模板的路径
2. 配置好模板之后，就要把对应的视图函数写一下了

这里先简单的做一个小总结：

django开发流程：

- 首先配置 URL，把 URL 和相应的视图函数绑定，一般写在 urls.py 文件里，
- 然后在工程的 urls.py 文件引入。
- 其次是编写视图函数，视图中需要渲染模板，我们也在 settings.py 中进行了模板相关的配置，让 Django 能够找到需要渲染的模板。
- 最后把渲染完成的 HTTP 响应返回就可以了。

1. 上述流程做完，就把基本的都做完了，现在我们就可以继续编写视图函数，去实现我们想要的功能了
2. 为了首页看起来更好看，从网上下载了一套模板系统，然后按照惯例，把CSS 和 JavaScript 文件放在 **blog 应用**的 static\ 目录下，同时，为了避免和其它应用中的 CSS 和 JavaScript 文件命名冲突（别的应用下也可能有和 blog 应用下同名的 CSS 、JavaScript 文件），我们再在 static\ 目录下建立一个 blog 文件夹，把下载的博客模板中的 css 和 js 文件夹连同里面的全部文件一同拷贝进这个目录，最后用下载的博客模板中的 index.html 文件替换掉之前我们自己写的 index.html 文件，但是运行之后看到首页的样子非常混乱，原因是我们没有正确的处理CSS 和 JavaScript 等静态文件的加载路径
3. 设置正确加载路径：CSS 样式文件通常在 HTML 文档的 head 标签里引入，CSS 样式文件的路径在 link 标签的 href 属性里，而 JavaScript 文件的路径在 script 标签的 src 属性里。
4. 这里引入了**{% static %} 模板标签**，但是别忘了在最顶部 {% load staticfiles %} 。static 模板标签位于 staticfiles 模块中，只有通过 load 模板标签将该模块引入后，才能在模板中使用 {% static %} 标签。
5. 插入模板之后我们就要按照自己想要的视图来修改模板了
6. 因为首页要显示发布的文章的数据，我们需要在模板文件中把每一篇文章的数据显示出来，这时候就要在模板中循环`post_list` 变量，这时候用到了 {% for %} 模板标签
7. 首页文章的显示设置好之后，我们需要先在博客中写点文章，这样才能看到样式
8. 但是在发布文章之前，需要先注册admin 后台管理账户，通过命令：python manage.py createsuperuser　创建一个超级管理员，按照提示输入即可创建成功
9. 然后还需要在后台导入我们创建的几个模型，这样Django Admin 后台才能知道我们都有哪些模型，这时候就需要去写admin.py文件中的代码了
10. 配置好后台，发布文章之后，怎么访问文章详情呢？接下来就是文章详情页的定制